Name,Query,Risk,tag,Notes
Connections from external addresses towards internal machine(s),(netconn_ipv4:[0.0.0.1 TO 9.255.255.255]  OR netconn_ipv4:[11.0.0.0 TO 127.0.0.0] OR netconn_ipv4:[127.0.0.2 TO 171.255.255.255] OR netconn_ipv4:[173.0.0.0 TO 191.255.255.255] OR netconn_ipv4:[193.0.0.0 TO 255.255.255.255]) AND netconn_inbound:true ,2,network_mapping,
Connections from internal machine towards external addresse(s),(netconn_ipv4:[0.0.0.1 TO 9.255.255.255]  OR netconn_ipv4:[11.0.0.0 TO 127.0.0.0] OR netconn_ipv4:[127.0.0.2 TO 171.255.255.255] OR netconn_ipv4:[173.0.0.0 TO 191.255.255.255] OR netconn_ipv4:[193.0.0.0 TO 255.255.255.255]) AND netconn_inbound:false,2,network_mapping,
Connections of process that are hosting injected thread,netconn_count:[1 TO *] AND ttp:INJECT_CODE,7,network_oddities,
External connections from/towards processes with listening connections,(netconn_ipv4:[0.0.0.1 TO 9.255.255.255]  OR netconn_ipv4:[11.0.0.0 TO 127.0.0.0] OR netconn_ipv4:[127.0.0.2 TO 171.255.255.255] OR netconn_ipv4:[173.0.0.0 TO 191.255.255.255] OR netconn_ipv4:[193.0.0.0 TO 255.255.255.255]) AND netconn_inbound:true AND ttp:FIXED_PORT_LISTEN,7,network_oddities,
Hunt for mail connections offsite,(netconn_ipv4:[0.0.0.1 TO 9.255.255.255] OR netconn_ipv4:[11.0.0.0 TO 127.0.0.0] OR netconn_ipv4:[127.0.0.2 TO 171.255.255.255] OR netconn_ipv4:[173.0.0.0 TO 191.255.255.255] OR netconn_ipv4:[193.0.0.0 TO 255.255.255.255]) AND (netconn_port:587 OR netconn_port:25 OR netconn_domain:smtp* OR netconn_domain:*mail*) ,3,network_oddities,
Hunt for strange DNS traffic,ttp:LOW_REPUTATION_SITE OR ttp:SUSPICIOUS_DOMAIN OR ttp:SUSPICIOUS_SITE ,7,network_oddities,
"Processes that are not signed and verified, which have unresolved domain DNS lookups:",process_publisher_state:FILE_SIGNATURE_STATE_NOT_SIGNED AND NOT process_publisher_state:FILE_SIGNATURE_STATE_VERIFIED AND netconn_failed:true,5,network_oddities,
Hunt for unsigned modules in signed processes/binaries,process_publisher_state:FILE_SIGNATURE_STATE_SIGNED AND modload_publisher_state:FILE_SIGNATURE_STATE_NOT_SIGNED ,3,loaded_modules,
Hunt for shell children of MS Office,(process_name:cmd.exe OR process_name:powershell.exe) AND (parent_name:winword.exe OR parent_name:powerpnt.exe OR parent_name:excel.exe),2,process_anomalies,
Hunt for remote desktop control,process_name:vnc.exe OR process_name:mstsc.exe OR process_name:vncviewer.exe,3,process_anomalies,
Hunt for PsExec,process_name:psexec.exe OR process_name:rexec.exe,3,process_anomalies,
Hunt for firewall modifications and port forwarding,regmod_name:FirewallRules*,3,process_anomalies,
Hunt for binaries running from temp,process_name:temp\\*,2,process_anomalies,
Hunt for binaries running from temp 2,process_name:C\:\\Temp\\*.exe OR process_name:C\:\\Users\\*\\Appdata\\Local\\Temp\\*.exe,2,process_anomalies,
Hunt for services running from desktop,process_name:\\Users\\**\\desktop\\** AND parent_name:svchost.exe,2,process_anomalies,
Hunt for unknown unsigned binaries,process_publisher_state:FILE_SIGNATURE_STATE_NOT_SIGNED AND (process_reputation:NOT_LISTED OR process_reputation:RESOLVING),2,process_anomalies,
Hunt for registry keys in command lines,(process_cmdline:HKEY OR process_cmdline:HKLM OR process_cmdline:HKU) AND process_name:cmd.exe,5,process_anomalies,
Hunt for javascript in command lines,(process_cmdline:.js OR process_cmdline:java) AND process_name:cmd.exe,4,process_anomalies,
Hunt for unsigned normally signed binaries,(process_name:explorer.exe~ OR process_name:svchost.exe~ OR process_name:powershell.exe~ OR process_name:lsass.exe~) AND process_publisher_state:FILE_SIGNATURE_STATE_NOT_SIGNED ,8,process_anomalies,
Hunt for processes with listening connections,ttp:FIXED_PORT_LISTEN,4,process_anomalies,
Hunt for children of Microsoft Office,(process_name:winword.exe OR process_name:powerpnt.exe OR process_name:excel.exe) AND childproc_count:[1 TO *],3,process_anomalies,
Hunt for children of Microsoft Office 2,process_product_name:*office* childproc_count:[1 TO *],3,process_anomalies,
Hunt for net user or net create,process_cmdline:net\ user OR process_cmdline:\/add OR process_name:wce.exe OR process_cmdline:net\ create,8,process_anomalies,
Revenge Rat,(childproc_name:svchost.exe AND process_publisher_state:FILE_SIGNATURE_STATE_NOT_SIGNED AND device_os:WINDOWS),8,uncommon_rats,
NetSupport Rat,"process_publisher:""NetSupport Ltd"" AND netconn_count:[1 TO *]",8,uncommon_rats,
Gh0st RAT of IronTiger,filemod_name:C\:\\*\\windows\\*.exe AND filemod_name:C\:\\*.vbs AND childproc_name:wscript.exe AND modload_publisher_state:FILE_SIGNATURE_STATE_NOT_SIGNED AND regmod_name:connectgroup,8,uncommon_rats,
Remcos RAT Variant,modload_name:remcos.exe AND netconn_count:[1 TO *],9,uncommon_rats,
Hunt for use of RDP,netconn_port:3389,2,rdp,
Hunt for volume shadow copy deletes,process_cmdline:delete AND process_cmdline:shadows,7,shadow_copies,
Hunt for disabling of boot loader recovery,process_cmdline:fdisk\ /mbr OR process_cmdline:cipher,8,bootloader_disable,
Hunt for file sharing apps,process_name:ftp.exe OR process_name:onedrive.exe OR process_name:dropbox.exe,3,filesharing,
Hunt for binaries downloaded from internet,(process_name:iexplore.exe OR process_name:firefox.exe OR process_name:chrome.exe) AND filemod_name:*.exe,1,internet_binary_download,
Hunt for HTTP in command lines,process_cmdline:http,4,http_cmdline,
Hunt for Base64 in command lines,process_name:powershell.exe AND process_cmdline:FromBase64String,6,powershell_obfuscation,
Hunt for JAVA RATs,process_name:javaw.exe AND (childproc_name:cmd.exe AND childproc_name:attrib.exe),8,uncommon_rats,
Hunt for SVCHOST.exe without the traditional parent of SERVICES.exe:,process_name:svchost.exe AND NOT parent_name:services.exe AND parent_name:*,8,unusual_parent,
Hunt for hidden powershell,process_name:powershell.exe AND process_cmdline:hidden,6,powershell_obfuscation,
Hunt for Obfuscated powershell,process_name:powershell.exe AND process_cmdline:Encoded-Command,7,powershell_obfuscation,
Hunt for Obfuscated powershell 2,process_name:powershell.exe AND process_cmdline:iex,6,powershell_obfuscation,
Hunt for Powershell download commands,process_name:powershell.exe AND process_cmdline:http,5,http_cmdline,
Hunt for encoded Powershell processes,"process_name:powershell* AND (process_cmdline:*\^* OR process_cmdline:\-Enc OR process_cmdline:\-NoP OR process_cmdline:\-Exec OR process_cmdline:bypass OR process_cmdline:hidden OR process_cmdline:\-EncodedCommand OR process_cmdline:IEX OR process_cmdline:Invoke-Expression)
",7,powershell_obfuscation,
Hunt for unsigned unknown wmiprve system children,parent_name:wmiprvse.exe AND process_publisher_state:FILE_SIGNATURE_STATE_NOT_SIGNED -legacy:true,5,unsigned_system_children,
Hunt for children of cscript and wscript,parent_name:csript.exe OR parent_name:wscript.exe,2,cscript_wscript_children,
Hunt for PowerShell in Services,(parent_name:services.exe or parent_name:svchost.exe) AND process_name:powershell.exe,6,powershell_services,
Powershell Web Client access,process_cmdline:*WebClient AND process_cmdline:*.ps1,5,powershell_webclient,
"All processes, which have image files that have executed from Temp Folder and not signed",process_name:*temp\\* AND process_publisher_state:FILE_SIGNATURE_STATE_NOT_SIGNED,3,unsigned_temp,
Hunt for unsigned drivers,modload_publisher_state:FILE_SIGNATURE_STATE_NOT_SIGNED,3,unsigned_drivers,
Hunt for modified hosts files,filemod_name:C\:\\windows\\system32\\drivers\\etc\\hosts,4,host_file_modification,
"Hunt for email related assets running exchange, lotus, smtp, pop3, imap, etc",(process_name:outlook.exe OR process_name:notes.exe) AND (netconn_port:25 OR netconn_port:110 OR netconn_port:143 OR netconn_port:465 OR netconn_port:587 OR netconn_port:993),3,asset_mapping,
Has suspicious internal connections,(process_name:ftp.exe AND NOT netconn_port:21) OR ((process_name:ssh* OR process_name:putty.exe) AND NOT netconn_port:22),4,suspect_netconns,
High number of internal connections,netconn_count:[500 TO *] AND (netconn_ipv4:10.* OR netconn_ipv4:192.* OR netconn_ipv4:172.*),4,suspect_netconns,
Absolute high number of internal outgoing embroyonic connections,netconn_count:[500 TO *] AND netconn_failed:true,4,suspect_netconns,
First execution of downloaded file,process_name:downloads\\* OR process_name:Content.Outlook\\*,4,penetration_vectors,
Processes with autorun registry key,regmod_name:CurrentVersion\\Run*,4,autorun_persistence,
Scheduled task executed from temp,process_name:temp\\* AND parent_name:schtasks.exe OR parent_name:taskeng.exe OR parent_name:taskhostex.exe OR parent_name:Backgroundtaskhost.exe,7,schedtask_temp,
Scheduled task executed from temp 2,process_name:temp\\* AND parent_name:schtasks.exe OR parent_name:at.exe OR parent_name:cron*,7,schedtask_temp,
Startup windows folder <Search for executable files in a location which usually saves shortcuts>,filemod_name:Start\ Menu\\Programs\\Startup\\* OR process_name:Start\ Menu\\Programs\\Startup\\*,3,windows_startup,
Runas,process_name:runas.exe OR process_cmdline:runas,3,hunt_runas,
Process hierarchy,parent_name:chrome.exe AND process_name:cmd.exe AND childproc_name:powershell.exe,8,unusual_invocation,
Unsigned process which is a child or a grandchild of wmiprvse.exe and is executed with system,process_publisher_state:FILE_SIGNATURE_STATE_NOT_SIGNED AND parent_name:wmiprvse.exe AND process_username:SYSTEM,5,lateral_movement,
Execution of unsigned child or grandchild by wmic.exe,parent_name:wmic.exe AND process_publisher_state:FILE_SIGNATURE_STATE_NOT_SIGNED,5,wmic_unsigned_child,
Pass the ticket,"process_cmdline:""kerberos::golden"" OR process_cmdline:""kerberos::ptt""",9,pass_the_ticket,
Pass the Hash (tool example),process_cmdline:SEKURLSA,9,pass_the_hash,
Obfuscate/Encode with Certutil,process_name:certutil.exe AND process_cmdline:\-encode*,7,certutil_obfuscation,
Mac - Locate Hidden Users,process_name:dscl AND process_cmdline:*create*,5,mac_hidden_users,
Credential Theft - Linux,process_name:cat AND process_cmdline:sudoers,6,linux_cred_theft,
Compiled HTML Code execution,process_cmdline:*.chm AND childproc_name:cmd.exe,6,html_code_execution,
Ransomware Extensions,((filemod_name:*.*CERBER*  OR filemod_name:*.*WASTED* OR filemod_name:*.0X0 OR filemod_name:*.0X009D8A OR filemod_name:*.0X5BM OR filemod_name:*.1999 OR filemod_name:*.1CBU1 OR filemod_name:*.1TXT OR filemod_name:*.342 OR filemod_name:*.3NCRY OR filemod_name:*.3P7M OR filemod_name:*.3RNU OR filemod_name:*.3V3R1S OR filemod_name:*.492 OR filemod_name:*.4RW5RW OR filemod_name:*.666 OR filemod_name:*.725 OR filemod_name:*.726 OR filemod_name:*.73I87A OR filemod_name:*.777 OR filemod_name:*.7H9R OR filemod_name:*.7ZIPPER OR filemod_name:*.8LOCK8 OR filemod_name:*._____ OR filemod_name:*.__DILMAV1 OR filemod_name:*._AIRACROPENCRYPTED OR filemod_name:*._RYP OR filemod_name:*.A5ZFN OR filemod_name:*.AAA OR filemod_name:*.ABC) AND -process_name:splunkd.exe),10,ransomware,
Nirsoft,(process_publisher:Nir\ Sofer),5,nirsoft,
Non-Microsoft Netconns,((process_name:winword.exe OR process_name:excel.exe OR process_name: powerpnt.exe) AND (netconn_domain:/[^.]+(\.[^.]+)+&@&~(.*live.com)/ AND netconn_domain:/[^.]+(\.[^.]+)+&@&~(.*office.net)/ AND netconn_domain:/[^.]+(\.[^.]+)+&@&~(.*microsoft.com)/ AND netconn_domain:/[^.]+(\.[^.]+)+&@&~(.*office.com)/)),6,office_unusual_netconns,
Hunt for binaries with dual extension 2,"process_name:/[^\/]+\\.[^\/]{2,3}\\.[^\/]{2,3}/",6,process_anomalies,